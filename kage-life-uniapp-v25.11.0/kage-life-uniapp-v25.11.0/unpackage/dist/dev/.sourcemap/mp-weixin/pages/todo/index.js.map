{"version":3,"file":"index.js","sources":["pages/todo/index.vue","../../../../programs/HBuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdG9kby9pbmRleC52dWU"],"sourcesContent":["<template>\n  <view class=\"todo-page\">\n    <view class=\"top\">\n      <view>\n        <view class=\"title\">ÂæÖÂäûÊ∏ÖÂçï</view>\n        <view class=\"sub\">‰ªäÂ§©Ôºö‰øùÊåÅ‰∏ìÊ≥®ÔºåÂÅöÂÆåÂ∞±ÂãæÊéâ</view>\n      </view>\n      <view class=\"sync-tag\">‰∏é Timeline+ ÂØπÂ∫î</view>\n    </view>\n\n    <view class=\"tabs\">\n      <view\n        v-for=\"tab in tabs\"\n        :key=\"tab.key\"\n        class=\"tab-item\"\n        :class=\"{ active: activeTab === tab.key }\"\n        @tap=\"switchTab(tab.key)\"\n      >\n        {{ tab.label }}\n      </view>\n    </view>\n\n    <view class=\"stat-line\">\n      <text>{{ statText }}</text>\n    </view>\n\n    <view v-if=\"listLoading\" class=\"empty\">Âä†ËΩΩ‰∏≠...</view>\n    <view v-else-if=\"!items.length\" class=\"empty\">ÊöÇÊó†ÂæÖÂäû</view>\n\n    <view v-else class=\"card-list\">\n      <view\n        v-for=\"item in items\"\n        :key=\"item.id\"\n        class=\"todo-card\"\n        :class=\"['priority-' + item.priority, { 'is-done': item.is_done }]\"\n      >\n        <view class=\"left-bar\"></view>\n        <view class=\"card-content\">\n          <view class=\"card-header\">\n            <text class=\"card-title\" :class=\"{ done: item.is_done }\">\n              {{ item.title }}\n            </text>\n            <view\n              class=\"tag\"\n              :class=\"item.is_done ? 'tag-done' : tagClass(item.priority)\"\n            >\n              {{ item.is_done ? 'Â∑≤ÂÆåÊàê' : tagLabel(item.priority) }}\n            </view>\n          </view>\n\n          <view class=\"card-meta\">\n            <text class=\"deadline\">Êà™Ê≠¢Ôºö{{ deadlineLabel(item) }}</text>\n            <text v-if=\"item.note\" class=\"note\">{{ item.note }}</text>\n          </view>\n\n          <view class=\"card-actions\">\n            <view\n              class=\"btn primary\"\n              v-if=\"!item.is_done\"\n              @tap=\"markDone(item)\"\n            >\n              ÂÆåÊàê\n            </view>\n            <view\n              class=\"btn ghost\"\n              v-else\n              @tap=\"undoDone(item)\"\n            >\n              Êí§ÈîÄÂÆåÊàê\n            </view>\n            <view class=\"btn danger\" @tap=\"removeTodo(item)\">\n              Âà†Èô§\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <view class=\"bottom-nav\">\n      <view class=\"nav-item\" @tap=\"goTimeline\">\n        <view class=\"nav-icon muted\">üìÖ</view>\n        <text class=\"nav-label\">Êó∂Èó¥Á∫ø</text>\n      </view>\n      <view class=\"nav-item active\">\n        <view class=\"nav-icon\">‚úÖ</view>\n        <text class=\"nav-label\">ÂæÖÂäû</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { computed, ref } from \"vue\"\nimport { onLoad } from \"@dcloudio/uni-app\"\n\nconst BASE_URL = \"http://127.0.0.1:8000/api\"\n\nconst tabs = [\n  { key: \"all\", label: \"ÂÖ®ÈÉ®\" },\n  { key: \"today\", label: \"‰ªäÂ§©Âà∞Êúü\" },\n  { key: \"important\", label: \"‰ªÖÈáçË¶Å\" },\n  { key: \"done\", label: \"Â∑≤ÂÆåÊàê\" }\n]\n\nconst activeTab = ref(\"all\")\nconst items = ref([])\nconst stats = ref({ total: 0, done: 0, todo: 0 })\nconst listLoading = ref(false)\n\nconst todayStr = () => {\n  const d = new Date()\n  const y = d.getFullYear()\n  const m = String(d.getMonth() + 1).padStart(2, \"0\")\n  const day = String(d.getDate()).padStart(2, \"0\")\n  return `${y}-${m}-${day}`\n}\n\nconst tomorrowStr = () => {\n  const d = new Date()\n  d.setDate(d.getDate() + 1)\n  const y = d.getFullYear()\n  const m = String(d.getMonth() + 1).padStart(2, \"0\")\n  const day = String(d.getDate()).padStart(2, \"0\")\n  return `${y}-${m}-${day}`\n}\n\nconst statText = computed(() => {\n  if (activeTab.value === \"done\") {\n    return `‰ªäÊó•Â∑≤ÂÆåÊàê ${stats.value.done} È°π`\n  }\n  const prefix =\n    activeTab.value === \"today\"\n      ? \"‰ªäÊó•ÂæÖÂäû\"\n      : activeTab.value === \"important\"\n        ? \"ÈáçË¶ÅÂæÖÂäû\"\n        : \"ÂÖ®ÈÉ®ÂæÖÂäû\"\n  return `${prefix} ${stats.value.todo} È°π ¬∑ Â∑≤ÂÆåÊàê ${stats.value.done} È°π`\n})\n\nonLoad(() => {\n  fetchTodos()\n})\n\nconst fetchTodos = (tab = activeTab.value) => {\n  activeTab.value = tab\n  listLoading.value = true\n  uni.request({\n    url: `${BASE_URL}/todos/`,\n    method: \"GET\",\n    data: { tab },\n    success: (res) => {\n      if (res.statusCode === 200 && res.data) {\n        items.value = res.data.items || []\n        stats.value = res.data.stats || { total: 0, done: 0, todo: 0 }\n      } else {\n        uni.showToast({ title: \"Âä†ËΩΩÂ§±Ë¥•\", icon: \"none\" })\n      }\n    },\n    fail: () => {\n      uni.showToast({ title: \"ÁΩëÁªúÂºÇÂ∏∏\", icon: \"none\" })\n    },\n    complete: () => {\n      listLoading.value = false\n    }\n  })\n}\n\nconst switchTab = (tab) => {\n  if (tab === activeTab.value) return\n  fetchTodos(tab)\n}\n\nconst tagLabel = (priority) => {\n  if (priority === 3) return \"ÈáçË¶Å\"\n  if (priority === 1) return \"‰∏çÊÄ•\"\n  return \"ÊôÆÈÄö\"\n}\n\nconst tagClass = (priority) => {\n  if (priority === 3) return \"tag-red\"\n  if (priority === 1) return \"tag-green\"\n  return \"tag-yellow\"\n}\n\nconst deadlineLabel = (item) => {\n  const dateStr = item.deadline_date\n  const timeStr = item.deadline_time\n  let label = \"\"\n  if (dateStr === todayStr()) {\n    label = \"‰ªäÂ§©\"\n  } else if (dateStr === tomorrowStr()) {\n    label = \"ÊòéÂ§©\"\n  } else {\n    label = dateStr || \"Êú™ËÆæÁΩÆ\"\n  }\n  if (timeStr) {\n    return `${label} ${timeStr}`\n  }\n  return label\n}\n\nconst markDone = (item) => {\n  uni.request({\n    url: `${BASE_URL}/todos/${item.id}/status/`,\n    method: \"POST\",\n    data: { is_done: 1 },\n    success: (res) => {\n      if (res.statusCode === 200 && res.data?.item) {\n        fetchTodos(activeTab.value)\n      } else {\n        uni.showToast({ title: \"Êìç‰ΩúÂ§±Ë¥•\", icon: \"none\" })\n      }\n    },\n    fail: () => uni.showToast({ title: \"ÁΩëÁªúÂºÇÂ∏∏\", icon: \"none\" })\n  })\n}\n\nconst undoDone = (item) => {\n  uni.request({\n    url: `${BASE_URL}/todos/${item.id}/status/`,\n    method: \"POST\",\n    data: { is_done: 0 },\n    success: (res) => {\n      if (res.statusCode === 200 && res.data?.item) {\n        fetchTodos(activeTab.value)\n      } else {\n        uni.showToast({ title: \"Êìç‰ΩúÂ§±Ë¥•\", icon: \"none\" })\n      }\n    },\n    fail: () => uni.showToast({ title: \"ÁΩëÁªúÂºÇÂ∏∏\", icon: \"none\" })\n  })\n}\n\nconst removeTodo = (item) => {\n  uni.showModal({\n    title: \"Á°ÆËÆ§Âà†Èô§Ôºü\",\n    content: item.title,\n    success: (res) => {\n      if (!res.confirm) return\n      uni.request({\n        url: `${BASE_URL}/todos/${item.id}/delete/`,\n        method: \"POST\",\n        success: (resp) => {\n          if (resp.statusCode === 200) {\n            fetchTodos(activeTab.value)\n          } else {\n            uni.showToast({ title: \"Âà†Èô§Â§±Ë¥•\", icon: \"none\" })\n          }\n        },\n        fail: () => uni.showToast({ title: \"ÁΩëÁªúÂºÇÂ∏∏\", icon: \"none\" })\n      })\n    }\n  })\n}\n\nconst goTimeline = () => {\n  uni.redirectTo({\n    url: \"/pages/index/index\"\n  })\n}\n</script>\n\n<style scoped>\n.todo-page {\n  min-height: 100vh;\n  background: #f5f6fb;\n  padding: 28rpx 28rpx 200rpx;\n  box-sizing: border-box;\n}\n\n.top {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20rpx;\n}\n\n.title {\n  font-size: 36rpx;\n  font-weight: 700;\n  color: #1e1f24;\n}\n\n.sub {\n  margin-top: 6rpx;\n  color: #6b7080;\n  font-size: 26rpx;\n}\n\n.sync-tag {\n  padding: 12rpx 20rpx;\n  background: #f0f4ff;\n  color: #3a64ff;\n  border-radius: 28rpx;\n  font-size: 24rpx;\n}\n\n.tabs {\n  display: flex;\n  gap: 18rpx;\n  margin: 24rpx 0 12rpx;\n  flex-wrap: wrap;\n}\n\n.tab-item {\n  padding: 16rpx 26rpx;\n  border-radius: 999rpx;\n  background: #f0f1f5;\n  color: #4e5364;\n  font-size: 26rpx;\n}\n\n.tab-item.active {\n  background: linear-gradient(135deg, #1e2b5f, #2a3d7b);\n  color: #ffffff;\n  font-weight: 600;\n}\n\n.stat-line {\n  color: #6b7080;\n  font-size: 26rpx;\n  margin-bottom: 20rpx;\n}\n\n.card-list {\n  display: flex;\n  flex-direction: column;\n  gap: 18rpx;\n}\n\n.todo-card {\n  position: relative;\n  background: #ffffff;\n  border-radius: 22rpx;\n  padding: 26rpx 22rpx 20rpx 26rpx;\n  box-shadow: 0 12rpx 30rpx rgba(0, 0, 0, 0.04);\n}\n\n.todo-card .left-bar {\n  position: absolute;\n  left: 0;\n  top: 18rpx;\n  bottom: 18rpx;\n  width: 10rpx;\n  border-radius: 10rpx;\n}\n\n.priority-3 .left-bar {\n  background: linear-gradient(180deg, #ff6b6b, #ff3b30);\n}\n\n.priority-2 .left-bar {\n  background: linear-gradient(180deg, #f7b733, #f57c00);\n}\n\n.priority-1 .left-bar {\n  background: linear-gradient(180deg, #7ed957, #33b249);\n}\n\n.card-content {\n  margin-left: 20rpx;\n}\n\n.card-header {\n  display: flex;\n  align-items: center;\n  gap: 14rpx;\n  margin-bottom: 10rpx;\n}\n\n.card-title {\n  font-size: 30rpx;\n  font-weight: 700;\n  color: #1d1f24;\n  flex: 1;\n}\n\n.card-title.done {\n  color: #93a0b4;\n  text-decoration: line-through;\n}\n\n.tag {\n  padding: 10rpx 18rpx;\n  border-radius: 999rpx;\n  font-size: 22rpx;\n  color: #ffffff;\n}\n\n.tag-red {\n  background: linear-gradient(135deg, #ff6b6b, #ff3b30);\n}\n\n.tag-yellow {\n  background: linear-gradient(135deg, #f7b733, #f57c00);\n}\n\n.tag-green {\n  background: linear-gradient(135deg, #70d16b, #3ab54a);\n}\n\n.tag-done {\n  background: #e1e6ef;\n  color: #4c5a6e;\n}\n\n.card-meta {\n  display: flex;\n  flex-direction: column;\n  gap: 8rpx;\n  color: #5d6577;\n  font-size: 26rpx;\n  margin-bottom: 14rpx;\n}\n\n.deadline {\n  font-weight: 600;\n}\n\n.note {\n  color: #8892a7;\n}\n\n.card-actions {\n  display: flex;\n  gap: 16rpx;\n  margin-top: 6rpx;\n}\n\n.btn {\n  padding: 14rpx 26rpx;\n  border-radius: 14rpx;\n  font-size: 26rpx;\n  font-weight: 600;\n  text-align: center;\n  min-width: 140rpx;\n}\n\n.btn.primary {\n  background: #0f1f4b;\n  color: #ffffff;\n}\n\n.btn.ghost {\n  background: #eef1f7;\n  color: #1f2a3d;\n}\n\n.btn.danger {\n  background: #ffffff;\n  color: #d83c3c;\n  border: 2rpx solid #f1c7c7;\n}\n\n.todo-card.is-done {\n  background: #f4f6fa;\n}\n\n.empty {\n  text-align: center;\n  color: #96a0b1;\n  padding: 40rpx 0;\n  font-size: 26rpx;\n}\n\n.bottom-nav {\n  position: fixed;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 140rpx;\n  background-color: #ffffff;\n  border-top: 1rpx solid #e5e5e5;\n  display: flex;\n  align-items: center;\n  justify-content: space-around;\n  padding-bottom: 20rpx;\n  z-index: 900;\n}\n\n.nav-item {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 10rpx;\n  color: #8a8a8a;\n  font-size: 24rpx;\n}\n\n.nav-item.active {\n  color: #222222;\n  font-weight: 700;\n}\n\n.nav-icon {\n  width: 58rpx;\n  height: 58rpx;\n  border-radius: 14rpx;\n  background: linear-gradient(135deg, #daf1df, #b5e5c7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 30rpx;\n}\n\n.nav-icon.muted {\n  background: linear-gradient(135deg, #e5e9ff, #d1d9ff);\n}\n\n.nav-label {\n  font-size: 24rpx;\n}\n</style>\n","import MiniProgramPage from 'E:/projects2/kage-life/kage-life-uniapp-v25.11.0/kage-life-uniapp-v25.11.0/pages/todo/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","onLoad","uni"],"mappings":";;AA+FA,MAAM,WAAW;;;;AAEjB,UAAM,OAAO;AAAA,MACX,EAAE,KAAK,OAAO,OAAO,KAAM;AAAA,MAC3B,EAAE,KAAK,SAAS,OAAO,OAAQ;AAAA,MAC/B,EAAE,KAAK,aAAa,OAAO,MAAO;AAAA,MAClC,EAAE,KAAK,QAAQ,OAAO,MAAO;AAAA,IAC/B;AAEA,UAAM,YAAYA,cAAG,IAAC,KAAK;AAC3B,UAAM,QAAQA,cAAG,IAAC,EAAE;AACpB,UAAM,QAAQA,cAAAA,IAAI,EAAE,OAAO,GAAG,MAAM,GAAG,MAAM,GAAG;AAChD,UAAM,cAAcA,cAAG,IAAC,KAAK;AAE7B,UAAM,WAAW,MAAM;AACrB,YAAM,IAAI,oBAAI,KAAM;AACpB,YAAM,IAAI,EAAE,YAAa;AACzB,YAAM,IAAI,OAAO,EAAE,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AAClD,YAAM,MAAM,OAAO,EAAE,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAC/C,aAAO,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG;AAAA,IACzB;AAEA,UAAM,cAAc,MAAM;AACxB,YAAM,IAAI,oBAAI,KAAM;AACpB,QAAE,QAAQ,EAAE,QAAO,IAAK,CAAC;AACzB,YAAM,IAAI,EAAE,YAAa;AACzB,YAAM,IAAI,OAAO,EAAE,SAAQ,IAAK,CAAC,EAAE,SAAS,GAAG,GAAG;AAClD,YAAM,MAAM,OAAO,EAAE,QAAS,CAAA,EAAE,SAAS,GAAG,GAAG;AAC/C,aAAO,GAAG,CAAC,IAAI,CAAC,IAAI,GAAG;AAAA,IACzB;AAEA,UAAM,WAAWC,cAAQ,SAAC,MAAM;AAC9B,UAAI,UAAU,UAAU,QAAQ;AAC9B,eAAO,SAAS,MAAM,MAAM,IAAI;AAAA,MACjC;AACD,YAAM,SACJ,UAAU,UAAU,UAChB,SACA,UAAU,UAAU,cAClB,SACA;AACR,aAAO,GAAG,MAAM,IAAI,MAAM,MAAM,IAAI,YAAY,MAAM,MAAM,IAAI;AAAA,IAClE,CAAC;AAEDC,kBAAAA,OAAO,MAAM;AACX,iBAAY;AAAA,IACd,CAAC;AAED,UAAM,aAAa,CAAC,MAAM,UAAU,UAAU;AAC5C,gBAAU,QAAQ;AAClB,kBAAY,QAAQ;AACpBC,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,GAAG,QAAQ;AAAA,QAChB,QAAQ;AAAA,QACR,MAAM,EAAE,IAAK;AAAA,QACb,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,eAAe,OAAO,IAAI,MAAM;AACtC,kBAAM,QAAQ,IAAI,KAAK,SAAS,CAAE;AAClC,kBAAM,QAAQ,IAAI,KAAK,SAAS,EAAE,OAAO,GAAG,MAAM,GAAG,MAAM,EAAG;AAAA,UACtE,OAAa;AACLA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,UAC9C;AAAA,QACF;AAAA,QACD,MAAM,MAAM;AACVA,wBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,QAC9C;AAAA,QACD,UAAU,MAAM;AACd,sBAAY,QAAQ;AAAA,QACrB;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,YAAY,CAAC,QAAQ;AACzB,UAAI,QAAQ,UAAU;AAAO;AAC7B,iBAAW,GAAG;AAAA,IAChB;AAEA,UAAM,WAAW,CAAC,aAAa;AAC7B,UAAI,aAAa;AAAG,eAAO;AAC3B,UAAI,aAAa;AAAG,eAAO;AAC3B,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,CAAC,aAAa;AAC7B,UAAI,aAAa;AAAG,eAAO;AAC3B,UAAI,aAAa;AAAG,eAAO;AAC3B,aAAO;AAAA,IACT;AAEA,UAAM,gBAAgB,CAAC,SAAS;AAC9B,YAAM,UAAU,KAAK;AACrB,YAAM,UAAU,KAAK;AACrB,UAAI,QAAQ;AACZ,UAAI,YAAY,YAAY;AAC1B,gBAAQ;AAAA,MACZ,WAAa,YAAY,eAAe;AACpC,gBAAQ;AAAA,MACZ,OAAS;AACL,gBAAQ,WAAW;AAAA,MACpB;AACD,UAAI,SAAS;AACX,eAAO,GAAG,KAAK,IAAI,OAAO;AAAA,MAC3B;AACD,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,CAAC,SAAS;AACzBA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,GAAG,QAAQ,UAAU,KAAK,EAAE;AAAA,QACjC,QAAQ;AAAA,QACR,MAAM,EAAE,SAAS,EAAG;AAAA,QACpB,SAAS,CAAC,QAAQ;;AAChB,cAAI,IAAI,eAAe,SAAO,SAAI,SAAJ,mBAAU,OAAM;AAC5C,uBAAW,UAAU,KAAK;AAAA,UAClC,OAAa;AACLA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,UAC9C;AAAA,QACF;AAAA,QACD,MAAM,MAAMA,cAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,MAC7D,CAAG;AAAA,IACH;AAEA,UAAM,WAAW,CAAC,SAAS;AACzBA,oBAAAA,MAAI,QAAQ;AAAA,QACV,KAAK,GAAG,QAAQ,UAAU,KAAK,EAAE;AAAA,QACjC,QAAQ;AAAA,QACR,MAAM,EAAE,SAAS,EAAG;AAAA,QACpB,SAAS,CAAC,QAAQ;;AAChB,cAAI,IAAI,eAAe,SAAO,SAAI,SAAJ,mBAAU,OAAM;AAC5C,uBAAW,UAAU,KAAK;AAAA,UAClC,OAAa;AACLA,0BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,UAC9C;AAAA,QACF;AAAA,QACD,MAAM,MAAMA,cAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,MAC7D,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,SAAS;AAC3BA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS,KAAK;AAAA,QACd,SAAS,CAAC,QAAQ;AAChB,cAAI,CAAC,IAAI;AAAS;AAClBA,wBAAAA,MAAI,QAAQ;AAAA,YACV,KAAK,GAAG,QAAQ,UAAU,KAAK,EAAE;AAAA,YACjC,QAAQ;AAAA,YACR,SAAS,CAAC,SAAS;AACjB,kBAAI,KAAK,eAAe,KAAK;AAC3B,2BAAW,UAAU,KAAK;AAAA,cACtC,OAAiB;AACLA,8BAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,cAC9C;AAAA,YACF;AAAA,YACD,MAAM,MAAMA,cAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,QAAQ;AAAA,UACjE,CAAO;AAAA,QACF;AAAA,MACL,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,MAAM;AACvBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClQA,GAAG,WAAW,eAAe;"}